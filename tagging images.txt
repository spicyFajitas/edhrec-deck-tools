Git Tags → Docker Image Version Tags (GitHub Actions + GHCR)
1. Create and push a Git version tag
git tag -a v1.2.3 -m "Release v1.2.3"
git push origin v1.2.3
# or
git push --tags

2. Trigger workflow on Git tags
on:
  push:
    branches: ["main"]
    tags:
      - "v*"

3. Use the Git tag as the Docker image tag

GitHub provides the tag name via:

github.ref_name


Example:

tags: |
  ghcr.io/<owner>/<image>:${{ github.ref_name }}
  ghcr.io/${{ steps.owner.outputs.owner }}/edhrec-deck-analyzer:${{ github.sha }}

2. Short SHA tag (cleaner)

GitHub doesn’t provide a short SHA by default, but you can create one.

- name: Set short SHA
  id: sha
  run: echo "short=${GITHUB_SHA::7}" >> $GITHUB_OUTPUT

Then:

- name: Build and Push
  uses: docker/build-push-action@v5
  with:
    context: .
    push: true
    tags: |
      ghcr.io/${{ steps.owner.outputs.owner }}/edhrec-deck-analyzer:latest
      ghcr.io/${{ steps.owner.outputs.owner }}/edhrec-deck-analyzer:${{ steps.sha.outputs.short }}

Produces:

:image:v1.2.3

4. Tag both version and latest (recommended)
tags: |
  ghcr.io/<owner>/<image>:${{ github.ref_name }}
  ghcr.io/<owner>/<image>:latest

5. Optional: remove the v prefix
- run: echo "version=${GITHUB_REF_NAME#v}" >> $GITHUB_OUTPUT

tags: |
  ghcr.io/<owner>/<image>:${{ steps.version.outputs.version }}
  ghcr.io/<owner>/<image>:latest

6. Recommended tagging strategy

1.2.3 → immutable release

latest → most recent stable

sha-<commit> → debugging / rollback

Key takeaway

Push a Git tag (vX.Y.Z)

Workflow triggers on the tag

Docker image is automatically tagged with the same version